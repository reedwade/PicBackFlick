<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>PicBackFlick</title>

<style type="text/css">



#page_buttons {
    border: 1px solid #ccc;
    width: 200px;
    float: left;
    padding: 4px;
    margin-top: 9px;
}
.page_picker_button {
    width: 40px;
}

#photo_spots {
    padding: 4px;
    margin-left: 210px;
}
.photo_entry {
    border: 1px solid #eee;
    padding: 5px;
    margin: 5px;
    float: left;
    width: 180px;
}
.photo_entry img {
    float: left;
    margin-right: 4px;
}
.photo_options {
    font-size: 50%;
}
.photo_title {
    font-size: 75%;
}
.photo_desc {
    font-size: 50%;
}


body {
    background-color:white;
    margin:40px;
    color:#CC6633;
}
</style>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js" type="text/javascript"></script>

<script src="photo_db.js" type="text/javascript"></script>

<script type="text/javascript">

var page_size = 100
var num_pages = 0
var image_list = []

function set_page(page) {
    offset = (page-1) * page_size
    $('.page_picker_button').css('color','#000')
    $('.page_picker_button_'+page).css('color','red')
    $('#photo_spots').empty()
    var max_uploaded_date;
    var min_uploaded_date;
    for (i=0; i < page_size; i++) {
        p = image_list[i +offset]
        if (pbf[p]) {
            if (! pbf[p].id) {
                a = p.split('_')
                pbf[p].id = a[1]
                pbf[p].uploaded_date = a[0]
            }
            
            if (i==0) {
                max_uploaded_date = pbf[p].uploaded_date;
            }
            min_uploaded_date = pbf[p].uploaded_date;
            
            idir = '/'+pbf[p].id.slice(-2)+'/'+pbf[p].id
            v = ''
            if (pbf[p].v) {
                v = '<a href="video'+idir+'.'+pbf[p].v+'" target="_blank">[MOVIE]</a> '
            }
            if (! pbf[p].o) {
                pbf[p].o = 'jpg'
            }
            $('#photo_spots').append(
                '<div class="photo_entry">'+
                '<img src="img/s'+idir+'_s.jpg" width="75" height="75" />' +
                '<span class="photo_title">'+pbf[p].t+'</span>'+
                '<br/>'+
                '<span class="photo_options">'+
                '<a href="img/b'+idir+'_b.jpg" target="_blank">[Big]</a> '+
                '<a href="img/o'+idir+'_o.'+pbf[p].o+'" target="_blank">[Orig]</a> '+
                '<a href="http://flickr.com/photos/'+flickr_username+'/'+pbf[p].id+'" target="_blank">[Page]</a> '+
                v+
                '<a href="info/'+idir+'_full.js" target="_blank">[JSON]</a> '+
                '</span>'+
                '</div>')
        }
    }
    if (min_uploaded_date) {
        min_uploaded_date = new Date(1000*min_uploaded_date).toLocaleDateString()
        max_uploaded_date = new Date(1000*max_uploaded_date).toLocaleDateString()
        $('#date_range_info').html('page '+page+' of '+num_pages+', posted '+min_uploaded_date+' - '+max_uploaded_date)
    } else {
        $('#date_range_info').html('')
    }
}


$(function(){

    for (p in pbf) {
        image_list.push(p)
    }
    image_list.sort()
    image_list.reverse()
    num_pages = Math.ceil(image_list.length / page_size)

    $('#message').html(image_list.length+' items')
    
    var s = ''
    for (i=1; i <= num_pages; i++) {
        s += '<input type="button" value="'+i+'" class="page_picker_button page_picker_button_'+i+'" onclick="set_page('+i+')" />'
    }
    $('#page_buttons').append(s)
    set_page(1)

});
</script>


<body>
<h1>PicBackFlick</h1>
<p><span id="message"></span></p>
<p><span id="date_range_info"></span></p>

<div id="page_buttons"></div>
<div id="photo_spots"></div>


</body>
</html>
